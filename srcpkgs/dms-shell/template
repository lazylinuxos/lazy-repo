# Template file for 'dms-shell'
pkgname=dms-shell
_pkg1=DankMaterialShell
version=1.4.1
revision=1
archs="x86_64"
build_style=go
go_import_path="github.com/AvengeMedia/${_pkg1}"
go_build_tags=""
go_ldflags="-linkmode=external"
depends="dgop quickshell font-inter font-fira-ttf font-firacode material-symbols-variable-ttf"
optdepends="
 brightnessctl: laptop display brightness control
 cava: audio visualizer
 cliphist: clipboard history
 matugen: dynamic wallpaper-based theming
 NetworkManager: network management
 qt5ct: Qt5 application theming
 qt6ct: Qt6 application theming
 wl-clipboard: clipboard utilities
"
short_desc="A Quickshell-based desktop shell with Material 3 design principles"
maintainer="nerdyslacker <karyan40024@gmail.com>"
license="GPL-3.0-only"
homepage="https://github.com/AvengeMedia/${_pkg1}"
distfiles="https://github.com/AvengeMedia/${_pkg1}/archive/v${version}/${_pkg1}-${version}.tar.gz"
checksum="47efa145d6898edd10c176e7cb2cb9fb0c760b465b3d318b4a4fa2caa963dc35"

do_build() {
	cd core 
	export CGO_CPPFLAGS="$CPPFLAGS"
	export CGO_CFLAGS="$CFLAGS"
	export CGO_CXXFLAGS="$CXXFLAGS"
	export CGO_LDFLAGS="$LDFLAGS"
	export GOFLAGS="-buildmode=pie -trimpath -mod=readonly -modcacherw -ldflags=${go_ldflags}"
	go build -o dms ./cmd/dms
}

do_install() {
	vbin core/dms

	vmkdir etc/xdg/quickshell/dms
	vcopy quickshell/* etc/xdg/quickshell/dms/

	vmkdir usr/share/doc/${pkgname}
	vinstall README.md 644 usr/share/doc/${pkgname}/
	vcopy docs/* usr/share/doc/${pkgname}/
}

dms-shell-niri_package() {
	short_desc+=" (for Niri)"
	depends="${sourcepkg} niri"
	pkg_install() {
		vmkdir usr/share/doc/dms-shell-niri
		vcopy ${DESTDIR}/usr/share/doc/dms-shell/* usr/share/doc/dms-shell-niri/
	}	
}

# dms-shell-hyprland_package() {
# 	short_desc+=" (for Hyprland)"
# 	depends="${sourcepkg} hyprland"
# 	pkg_install() {
	# 	vmkdir usr/share/doc/dms-shell-hyprland
	# 	vcopy ${DESTDIR}/usr/share/doc/dms-shell/* usr/share/doc/dms-shell-hyprland/
	# }
# }
